<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="img/flowers.png" type="image/x-icon" />
    <link rel="stylesheet" href="css/style.css">
    <title>Flores Para Ti - 21 de Septiembre</title>
</head>

<body class="container">
    <!-- Audio principal con autoplay mejorado -->
    <audio id="mainAudio" loop autoplay muted>
        <source src="sound/FloresAmarillas.mp3" type="audio/mpeg">
    </audio>

    <!-- Estrellas cayendo en el fondo -->
    <div class="falling-stars" id="fallingStars"></div>

    <!-- CONTENEDOR M√ìVIL VERTICAL (SOLO VISIBLE EN M√ìVILES) -->
    <div class="mobile-container">
        <!-- 1. MENSAJE PRINCIPAL -->
        <div class="main-message">
            <div class="sunflower-icon">üåª</div>
            <div class="message-text">
                Flores Para Ti<br>
                <span class="date-highlight">Feliz 21 de Septiembre</span>
            </div>
            <div class="sunflower-icon">üåª</div>
        </div>

        <!-- 2. FLORES - PROTAGONISTAS ABSOLUTAS (TODO EL ESPACIO) -->
        <div class="flowers-container">
            <div class="flowers" id="mobileFlowersContainer">
                <!-- Girasol 1 -->
                <div class="flower flower--1" data-flower-id="1">
                    <div class="flower__leafs flower__leafs--1">
                        <div class="flower__leaf flower__leaf--1"></div>
                        <div class="flower__leaf flower__leaf--2"></div>
                        <div class="flower__leaf flower__leaf--3"></div>
                        <div class="flower__leaf flower__leaf--4"></div>
                        <div class="flower__white-circle"></div>

                        <div class="flower__light flower__light--1"></div>
                        <div class="flower__light flower__light--2"></div>
                        <div class="flower__light flower__light--3"></div>
                        <div class="flower__light flower__light--4"></div>
                        <div class="flower__light flower__light--5"></div>
                        <div class="flower__light flower__light--6"></div>
                        <div class="flower__light flower__light--7"></div>
                        <div class="flower__light flower__light--8"></div>
                    </div>
                    <div class="flower__line">
                        <div class="flower__line__leaf flower__line__leaf--1"></div>
                        <div class="flower__line__leaf flower__line__leaf--2"></div>
                        <div class="flower__line__leaf flower__line__leaf--3"></div>
                        <div class="flower__line__leaf flower__line__leaf--4"></div>
                        <div class="flower__line__leaf flower__line__leaf--5"></div>
                        <div class="flower__line__leaf flower__line__leaf--6"></div>
                    </div>
                </div>

                <!-- Girasol 2 -->
                <div class="flower flower--2" data-flower-id="2">
                    <div class="flower__leafs flower__leafs--2">
                        <div class="flower__leaf flower__leaf--1"></div>
                        <div class="flower__leaf flower__leaf--2"></div>
                        <div class="flower__leaf flower__leaf--3"></div>
                        <div class="flower__leaf flower__leaf--4"></div>
                        <div class="flower__white-circle"></div>

                        <div class="flower__light flower__light--1"></div>
                        <div class="flower__light flower__light--2"></div>
                        <div class="flower__light flower__light--3"></div>
                        <div class="flower__light flower__light--4"></div>
                        <div class="flower__light flower__light--5"></div>
                        <div class="flower__light flower__light--6"></div>
                        <div class="flower__light flower__light--7"></div>
                        <div class="flower__light flower__light--8"></div>
                    </div>
                    <div class="flower__line">
                        <div class="flower__line__leaf flower__line__leaf--1"></div>
                        <div class="flower__line__leaf flower__line__leaf--2"></div>
                        <div class="flower__line__leaf flower__line__leaf--3"></div>
                        <div class="flower__line__leaf flower__line__leaf--4"></div>
                    </div>
                </div>

                <!-- Girasol 3 -->
                <div class="flower flower--3" data-flower-id="3">
                    <div class="flower__leafs flower__leafs--3">
                        <div class="flower__leaf flower__leaf--1"></div>
                        <div class="flower__leaf flower__leaf--2"></div>
                        <div class="flower__leaf flower__leaf--3"></div>
                        <div class="flower__leaf flower__leaf--4"></div>
                        <div class="flower__white-circle"></div>

                        <div class="flower__light flower__light--1"></div>
                        <div class="flower__light flower__light--2"></div>
                        <div class="flower__light flower__light--3"></div>
                        <div class="flower__light flower__light--4"></div>
                        <div class="flower__light flower__light--5"></div>
                        <div class="flower__light flower__light--6"></div>
                        <div class="flower__light flower__light--7"></div>
                        <div class="flower__light flower__light--8"></div>
                    </div>
                    <div class="flower__line">
                        <div class="flower__line__leaf flower__line__leaf--1"></div>
                        <div class="flower__line__leaf flower__line__leaf--2"></div>
                        <div class="flower__line__leaf flower__line__leaf--3"></div>
                        <div class="flower__line__leaf flower__line__leaf--4"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. FRASES - AL FINAL -->
        <div class="quotes-section mobile-quotes">
            <h3>üåª Frases üåª</h3>
            <div class="quote-display short-text" id="mobileQuoteDisplay">
                "üå∫ La amistad es el ingrediente m√°s importante en la receta de la vida."
            </div>
            <div class="quote-controls">
                <button class="quote-btn" onclick="changeQuote()">Nueva Frase</button>
                <button class="quote-btn" onclick="toggleAutoQuote()" id="mobileAutoBtn">Auto: OFF</button>
            </div>
        </div>
    </div>

    <!-- CONTENIDO DESKTOP (SOLO VISIBLE EN DESKTOP) -->
    <!-- Mensaje principal con girasol -->
    <div class="main-message">
        <div class="sunflower-icon">üåª</div>
        <div class="message-text">
            Flores Para Ti<br>
            <span class="date-highlight">Feliz 21 de Septiembre</span>
        </div>
        <div class="sunflower-icon">üåª</div>
    </div>

    <!-- Control de m√∫sica mejorado con nombre de canci√≥n -->
    <div class="music-player">
        <h3>üéµ Control Musical</h3>
        <div class="current-song" id="currentSongName">
            ‚ô™
        </div>
        <div class="music-controls">
            <button class="control-btn" id="prevBtn">‚èÆÔ∏è</button>
            <button class="control-btn" id="playPauseBtn">‚ñ∂Ô∏è</button>
            <button class="control-btn" id="nextBtn">‚è≠Ô∏è</button>
        </div>
    </div>

    <!-- Secci√≥n de frases aleatorias ADAPTABLE -->
    <div class="quotes-section">
        <h3>üåª Frases üåª</h3>
        <div class="quote-display short-text" id="quoteDisplay">
            "üå∫ La amistad es el ingrediente m√°s importante en la receta de la vida."
        </div>
        <div class="quote-controls">
            <button class="quote-btn" onclick="changeQuote()">Nueva Frase</button>
            <button class="quote-btn" onclick="toggleAutoQuote()" id="autoBtn">Auto: OFF</button>
        </div>
    </div>

    <!-- Letras sincronizadas -->
    <div id="lyrics"></div>

    <!-- T√≠tulo principal -->
    <h1 class="titulo"></h1>

    <!-- Contenedor de flores -->
    <div class="flowers" id="flowersContainer">
        <!-- Girasol 1 -->
        <div class="flower flower--1" data-flower-id="1">
            <div class="flower__leafs flower__leafs--1">
                <div class="flower__leaf flower__leaf--1"></div>
                <div class="flower__leaf flower__leaf--2"></div>
                <div class="flower__leaf flower__leaf--3"></div>
                <div class="flower__leaf flower__leaf--4"></div>
                <div class="flower__white-circle"></div>

                <div class="flower__light flower__light--1"></div>
                <div class="flower__light flower__light--2"></div>
                <div class="flower__light flower__light--3"></div>
                <div class="flower__light flower__light--4"></div>
                <div class="flower__light flower__light--5"></div>
                <div class="flower__light flower__light--6"></div>
                <div class="flower__light flower__light--7"></div>
                <div class="flower__light flower__light--8"></div>
            </div>
            <div class="flower__line">
                <div class="flower__line__leaf flower__line__leaf--1"></div>
                <div class="flower__line__leaf flower__line__leaf--2"></div>
                <div class="flower__line__leaf flower__line__leaf--3"></div>
                <div class="flower__line__leaf flower__line__leaf--4"></div>
                <div class="flower__line__leaf flower__line__leaf--5"></div>
                <div class="flower__line__leaf flower__line__leaf--6"></div>
            </div>
        </div>

        <!-- Girasol 2 -->
        <div class="flower flower--2" data-flower-id="2">
            <div class="flower__leafs flower__leafs--2">
                <div class="flower__leaf flower__leaf--1"></div>
                <div class="flower__leaf flower__leaf--2"></div>
                <div class="flower__leaf flower__leaf--3"></div>
                <div class="flower__leaf flower__leaf--4"></div>
                <div class="flower__white-circle"></div>

                <div class="flower__light flower__light--1"></div>
                <div class="flower__light flower__light--2"></div>
                <div class="flower__light flower__light--3"></div>
                <div class="flower__light flower__light--4"></div>
                <div class="flower__light flower__light--5"></div>
                <div class="flower__light flower__light--6"></div>
                <div class="flower__light flower__light--7"></div>
                <div class="flower__light flower__light--8"></div>
            </div>
            <div class="flower__line">
                <div class="flower__line__leaf flower__line__leaf--1"></div>
                <div class="flower__line__leaf flower__line__leaf--2"></div>
                <div class="flower__line__leaf flower__line__leaf--3"></div>
                <div class="flower__line__leaf flower__line__leaf--4"></div>
            </div>
        </div>

        <!-- Girasol 3 -->
        <div class="flower flower--3" data-flower-id="3">
            <div class="flower__leafs flower__leafs--3">
                <div class="flower__leaf flower__leaf--1"></div>
                <div class="flower__leaf flower__leaf--2"></div>
                <div class="flower__leaf flower__leaf--3"></div>
                <div class="flower__leaf flower__leaf--4"></div>
                <div class="flower__white-circle"></div>

                <div class="flower__light flower__light--1"></div>
                <div class="flower__light flower__light--2"></div>
                <div class="flower__light flower__light--3"></div>
                <div class="flower__light flower__light--4"></div>
                <div class="flower__light flower__light--5"></div>
                <div class="flower__light flower__light--6"></div>
                <div class="flower__light flower__light--7"></div>
                <div class="flower__light flower__light--8"></div>
            </div>
            <div class="flower__line">
                <div class="flower__line__leaf flower__line__leaf--1"></div>
                <div class="flower__line__leaf flower__line__leaf--2"></div>
                <div class="flower__line__leaf flower__line__leaf--3"></div>
                <div class="flower__line__leaf flower__line__leaf--4"></div>
            </div>
        </div>
    </div>

</body>
<script>
    // Variables globales
    let audio = document.getElementById('mainAudio');
    let lyrics = document.querySelector("#lyrics");
    let flowerCounter = 3;
    let nextFlowerId = 4;
    let currentSongIndex = 0;
    let isPlaying = false;
    let autoQuoteEnabled = false;
    let quoteInterval;
    let autoFlowerInterval; // Para generar flores autom√°ticamente

    // Lista de canciones con nombres amigables
    const playlist = [
        {
            file: "sound/FloresAmarillas.mp3",
            name: "‚ô™ Flores Amarillas - Floricienta"
        },
        {
            file: "sound/ColorEsperanza.mp3",
            name: "‚ô™ Color Esperanza - Diego Torres"
        },
        {
            file: "sound/Sunflower.mp3", 
            name: "‚ô™ Sunflower - Post Malone & Swae Lee"
        },
        {
            file: "sound/Yellow.mp3",
            name: "‚ô™ Yellow - Coldplay"
        },
    ];

    // Frases rom√°nticas
    const romanticQuotes = [
        "üåº La vida es mejor con amigos que se vuelven familia",
        "üíõ La amistad verdadera no se trata de ser inseparables, sino de poder estar separados y que nada cambie",
        "‚ú® Un verdadero amigo es aquel que conoce tus cicatrices y a√∫n as√≠ elige quedarse.",
        "üå∫ La amistad es el ingrediente m√°s importante en la receta de la vida.",
        "üå∑ Un amigo es ese que convierte los momentos simples en recuerdos inolvidables.",
        "üíê La amistad no se mide por el tiempo, sino por la sinceridad y el cari√±o.",
        "üåû Un buen amigo ilumina tu vida como el sol ilumina la ma√±ana."
    ];

    // Array de letras sincronizadas
    const lyricsData = [
        { text: "üíõ La amistad es el puente que une corazones en cualquier distancia.", time: 15 },
        { text: "‚ú® Las risas compartidas con un amigo son los mejores recuerdos de la vida.", time: 18 },
        { text: "üå∫ La amistad sincera es un regalo que no se compra ni se vende, solo se cultiva.", time: 27 },
        { text: "üå∑ Un amigo verdadero es aquel que llega para quedarse en todas las estaciones de la vida.", time: 32 },
        { text: "üíê La amistad es un refugio donde el alma descansa.", time: 33 },
        { text: "üåû Tener un amigo es tener un tesoro que brilla m√°s que el oro.", time: 41 }
    ];

    // FUNCI√ìN AUTOPLAY MEJORADA PARA INICIAR INMEDIATAMENTE
    function initAutoplay() {
        // Estrategia m√∫ltiple para asegurar reproducci√≥n autom√°tica

        // 1. Intentar reproducir inmediatamente (sin muted)
        audio.muted = false;
        const playPromise = audio.play();

        if (playPromise !== undefined) {
            playPromise
                .then(() => {
                    console.log("üéµ Autoplay exitoso sin muted");
                    isPlaying = true;
                    updateCurrentSongName();
                    const playBtn = document.getElementById('playPauseBtn');
                    if (playBtn) playBtn.textContent = '‚è∏Ô∏è';
                })
                .catch(error => {
                    console.log("üéµ Autoplay bloqueado, probando con muted");
                    // 2. Si falla, intentar con muted y luego unmute
                    audio.muted = true;
                    audio.play().then(() => {
                        console.log("üéµ Reproduciendo con muted, preparando unmute");
                        isPlaying = true;
                        updateCurrentSongName();
                        const playBtn = document.getElementById('playPauseBtn');
                        if (playBtn) playBtn.textContent = '‚è∏Ô∏è';

                        // Unmute despu√©s de 100ms
                        setTimeout(() => {
                            audio.muted = false;
                            console.log("üéµ Audio unmuted - sonando completamente");
                        }, 100);
                    }).catch(() => {
                        // 3. √öltimo recurso: reproducir con primera interacci√≥n
                        console.log("üéµ √öltima opci√≥n: reproducir con interacci√≥n");
                        document.addEventListener('click', enableAutoplay, { once: true });
                        document.addEventListener('touchstart', enableAutoplay, { once: true });
                        document.addEventListener('keydown', enableAutoplay, { once: true });
                    });
                });
        }
    }

    function enableAutoplay() {
        if (!isPlaying) {
            audio.muted = false;
            audio.play().then(() => {
                isPlaying = true;
                updateCurrentSongName();
                const playBtn = document.getElementById('playPauseBtn');
                if (playBtn) playBtn.textContent = '‚è∏Ô∏è';
                console.log("üéµ Audio iniciado por interacci√≥n del usuario");
            }).catch(err => console.log('Error al reproducir:', err));
        }
    }

    // Funci√≥n para crear estrellas cayendo SOLO blancas y amarillas
    function createSimpleFallingStars() {
        const starsContainer = document.getElementById('fallingStars');
        const starTypes = ['‚≠ê', '‚ú®', '‚ú¶', '‚úß'];

        for (let i = 0; i < 30; i++) {
            const star = document.createElement('div');
            star.className = 'falling-star';
            star.textContent = starTypes[Math.floor(Math.random() * starTypes.length)];

            const isYellow = Math.random() > 0.5;
            star.classList.add(isYellow ? 'yellow' : 'white');

            star.style.left = Math.random() * 100 + '%';
            star.style.animationDuration = (Math.random() * 6 + 4) + 's';
            star.style.animationDelay = Math.random() * 8 + 's';
            star.style.fontSize = (Math.random() * 8 + 16) + 'px';

            starsContainer.appendChild(star);
        }
    }

    // Funci√≥n para actualizar el nombre de la canci√≥n
    function updateCurrentSongName() {
        const songNameElement = document.getElementById('currentSongName');
        const currentSong = playlist[currentSongIndex];

        if (songNameElement && currentSong) {
            songNameElement.textContent = currentSong.name;

            // Agregar/remover clase de animaci√≥n seg√∫n si est√° reproduciendo
            if (isPlaying) {
                songNameElement.classList.add('playing');
            } else {
                songNameElement.classList.remove('playing');
            }
        }
    }

    // Funciones de control musical mejoradas
    function togglePlayPause() {
        const btn = document.getElementById('playPauseBtn');
        if (isPlaying) {
            audio.pause();
            btn.textContent = '‚ñ∂Ô∏è';
            isPlaying = false;
        } else {
            audio.play();
            btn.textContent = '‚è∏Ô∏è';
            isPlaying = true;
        }
        updateCurrentSongName();
    }

    function playNextSong() {
        currentSongIndex = (currentSongIndex + 1) % playlist.length;
        loadSong(currentSongIndex);
    }

    function playPrevSong() {
        currentSongIndex = currentSongIndex > 0 ? currentSongIndex - 1 : playlist.length - 1;
        loadSong(currentSongIndex);
    }

    function loadSong(index) {
        const song = playlist[index];
        audio.src = song.file;
        updateCurrentSongName();

        if (isPlaying) {
            audio.play();
        }
    }

    // Funci√≥n para determinar la clase CSS seg√∫n la longitud del texto
    function getTextLengthClass(text) {
        const length = text.length;
        if (length <= 50) return 'short-text';
        if (length <= 100) return 'medium-text';
        return 'long-text';
    }

    // Funci√≥n para cambiar frases con adaptaci√≥n de tama√±o
    function changeQuote() {
        const quoteDisplay = document.getElementById('quoteDisplay');
        const mobileQuoteDisplay = document.getElementById('mobileQuoteDisplay');
        const randomIndex = Math.floor(Math.random() * romanticQuotes.length);
        const newQuote = `"${romanticQuotes[randomIndex]}"`;

        // Actualizar ambas versiones si existen
        [quoteDisplay, mobileQuoteDisplay].forEach(display => {
            if (display) {
                display.style.opacity = '0';

                setTimeout(() => {
                    // Remover clases anteriores
                    display.classList.remove('short-text', 'medium-text', 'long-text');

                    // Agregar nueva clase seg√∫n longitud
                    const lengthClass = getTextLengthClass(newQuote);
                    display.classList.add(lengthClass);

                    // Actualizar texto
                    display.textContent = newQuote;
                    display.style.opacity = '1';
                }, 300);
            }
        });
    }

    function toggleAutoQuote() {
        const btn = document.getElementById('autoBtn');
        const mobileBtn = document.getElementById('mobileAutoBtn');

        if (autoQuoteEnabled) {
            clearInterval(quoteInterval);
            autoQuoteEnabled = false;
            if (btn) btn.textContent = 'Auto: OFF';
            if (mobileBtn) mobileBtn.textContent = 'Auto: OFF';
        } else {
            quoteInterval = setInterval(changeQuote, 8000);
            autoQuoteEnabled = true;
            if (btn) btn.textContent = 'Auto: ON';
            if (mobileBtn) mobileBtn.textContent = 'Auto: ON';
        }
    }

    // FUNCI√ìN PARA CREAR ESTRELLAS AL TOCAR FLORES
    function createStarSparkles(element) {
        const sparkleTypes = ['‚≠ê', '‚ú®', '‚ú¶', 'üí´', 'üåü'];
        const rect = element.getBoundingClientRect();

        for (let i = 0; i < 12; i++) { // M√°s estrellas
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.textContent = sparkleTypes[Math.floor(Math.random() * sparkleTypes.length)];

            const isYellow = Math.random() > 0.4; // M√°s probabilidad de amarillo
            sparkle.style.color = isYellow ? '#FFD700' : 'white';
            sparkle.style.textShadow = isYellow ? 
                '0 0 15px #FFD700, 0 0 25px rgba(255, 215, 0, 0.5)' : 
                '0 0 15px white, 0 0 25px rgba(255, 255, 255, 0.5)';

            sparkle.style.left = rect.left + rect.width/2 + (Math.random() - 0.5) * 100 + 'px';
            sparkle.style.top = rect.top + rect.height/2 + (Math.random() - 0.5) * 100 + 'px';
            sparkle.style.animationDelay = i * 0.08 + 's';
            sparkle.style.fontSize = (Math.random() * 6 + 16) + 'px';

            document.body.appendChild(sparkle);

            setTimeout(() => {
                sparkle.remove();
            }, 2500);
        }
    }

    // FUNCI√ìN PARA GENERAR FLORES AUTOM√ÅTICAMENTE CADA 10-15 SEGUNDOS
    function autoGenerateFlower() {
        const containers = [
            document.getElementById('flowersContainer'),
            document.getElementById('mobileFlowersContainer')
        ];

        containers.forEach(container => {
            if (container && container.children.length < 8) { // M√°ximo 8 flores
                const newFlower = createNewFlower();
                if (newFlower) {
                    container.appendChild(newFlower);
                    flowerCounter++;

                    // Animar entrada
                    setTimeout(() => {
                        newFlower.classList.add('new-flower');

                        // Agregar eventos de toque para estrellas
                        newFlower.addEventListener('click', function() {
                            createStarSparkles(this);
                        });
                        newFlower.addEventListener('touchstart', function(e) {
                            e.preventDefault();
                            createStarSparkles(this);
                        });
                    }, 100);
                }
            }
        });
    }

    // FUNCI√ìN PARA CREAR NUEVA FLOR
    function createNewFlower() {
        const flowerTemplate = document.querySelector('.flower--1');
        if (!flowerTemplate) return null;

        const newFlower = flowerTemplate.cloneNode(true);
        newFlower.className = `flower flower--${(nextFlowerId % 3) + 1}`;
        newFlower.setAttribute('data-flower-id', nextFlowerId);

        // Posici√≥n aleatoria
        const positions = ['20%', '35%', '50%', '65%', '80%'];
        const randomPos = positions[Math.floor(Math.random() * positions.length)];
        newFlower.style.left = randomPos;

        // Variaci√≥n en altura
        const heights = ['45vmin', '55vmin', '65vmin'];
        const randomHeight = heights[Math.floor(Math.random() * heights.length)];
        const line = newFlower.querySelector('.flower__line');
        if (line) line.style.height = randomHeight;

        nextFlowerId++;
        return newFlower;
    }

    // FUNCI√ìN PARA INICIAR GENERACI√ìN AUTOM√ÅTICA DE FLORES
    function startAutoFlowerGeneration() {
        // Generar flores cada 10-15 segundos aleatoriamente
        const generateFlower = () => {
            autoGenerateFlower();
            const nextInterval = Math.random() * 5000 + 10000; // 10-15 segundos
            setTimeout(generateFlower, nextInterval);
        };

        // Iniciar despu√©s de 10 segundos
        setTimeout(generateFlower, 10000);
    }

    // Funci√≥n para sincronizar letras
    function updateLyrics() {
        if (!audio || audio.paused) return;

        const time = Math.floor(audio.currentTime);
        const currentLine = lyricsData.find(
            (line) => time >= line.time && time < line.time + 6
        );

        if (currentLine) {
            const fadeInDuration = 0.1;
            const opacity = Math.min(1, (time - currentLine.time) / fadeInDuration);
            lyrics.style.opacity = opacity;
            lyrics.innerHTML = currentLine.text;
        } else {
            lyrics.style.opacity = 0;
            lyrics.innerHTML = "";
        }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
        // INICIAR AUTOPLAY INMEDIATAMENTE AL CARGAR
        initAutoplay();

        createSimpleFallingStars();
        setInterval(createSimpleFallingStars, 40000);

        // Configurar controles musicales
        const playBtn = document.getElementById('playPauseBtn');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');

        if (playBtn) playBtn.addEventListener('click', togglePlayPause);
        if (nextBtn) nextBtn.addEventListener('click', playNextSong);
        if (prevBtn) prevBtn.addEventListener('click', playPrevSong);

        // Configurar auto-siguiente canci√≥n
        audio.addEventListener('ended', playNextSong);

        audio.volume = 0.7;

        // Inicializar nombre de canci√≥n
        updateCurrentSongName();

        setInterval(updateLyrics, 1000);

        // Configurar eventos de toque para flores existentes
        document.querySelectorAll('.flower').forEach(flower => {
            flower.addEventListener('click', function() {
                createStarSparkles(this);
            });
            flower.addEventListener('touchstart', function(e) {
                e.preventDefault();
                createStarSparkles(this);
            });
        });

        // Configurar primera frase con clase adecuada
        const initialQuote = document.getElementById('quoteDisplay');
        const mobileInitialQuote = document.getElementById('mobileQuoteDisplay');

        [initialQuote, mobileInitialQuote].forEach(quote => {
            if (quote) {
                const initialClass = getTextLengthClass(quote.textContent);
                quote.classList.remove('short-text');
                quote.classList.add(initialClass);
            }
        });

        // INICIAR GENERACI√ìN AUTOM√ÅTICA DE FLORES
        startAutoFlowerGeneration();
    });

    // Funci√≥n para ocultar t√≠tulo
    function ocultar_titulo() {
        const titulo = document.querySelector(".titulo");
        if (titulo) {
            titulo.style.animation = "fadeOut 3s ease-in-out forwards";
            setTimeout(() => {
                titulo.style.display = "none";
            }, 3000);
        }
    }

    // Detectar cambio de orientaci√≥n/tama√±o
    window.addEventListener('resize', function() {
        if (window.innerWidth <= 768) {
            // En m√≥vil: asegurar que las flores sean visibles
            const flowers = document.querySelectorAll('.flower');
            flowers.forEach(flower => {
                flower.style.display = 'block';
                flower.style.visibility = 'visible';
                flower.style.opacity = '1';
            });
        }
    });

    setTimeout(ocultar_titulo, 216000);
</script>
</html>